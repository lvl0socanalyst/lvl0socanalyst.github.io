---
layout: post
title:  "Shai-Hulud NPM Package Worm! (Stuxnet NPM Edition)"
date:   2025-09-09 21:00:00 +1000
categories: threat intel
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

Empire strikes back (DPRK) to steal more crypto!

Popular npm package Tinycolor (plus a casual other 38) we're compromised on the 15th of September with a worm that self-propagates and infects other packages (and cred/crypto stealing malware)!

Similar to the previous npm package compromise the malicious JS attempts to exfil:
- GitHub PAT tokens
- NPM Auth tokens
- Crypto

But with further functionality to exfil:
- GCP, Azure, AWS access keys and creds

## Threat Actor Attribution

Now although not confirmed, my money is on DPRK. 

The two exfil methods we're github public repo dumping and a webhook with a known webhook provider. This doesn't give any pivots to work off, therefore its hard to track this back to adversary infrastructure. 

Now in a message log we can see good old Scoot Cooper (scttcper) reckons he wasn't phished. 

![alt text](/images/scott.PNG)

So if the initial access vector ever comes out, hopefully we have some IOAs that we can search and try to attribute to an actor.

Until then, it was DPRK!!

## Self Propagating Aspect

Shai-Hulud is actually a big worm in Dune. It's pretty much the non copyright version of the Exogorth worm from Star Wars Empire Strikes Back.

Anyhow, to the actual worm.



## TruffleHog

Bundle.js uses TruffleHog to scan for secrets. (https://github.com/trufflesecurity/trufflehog)

TruffleHog is a go program that is used to discover secrets absolutely everywhere. Git, Cloud, File systems the lot.

I had never heard of this prior to this incident. So I've cloned it and cracked it open on my Kali box.

## Error Beep Bop
