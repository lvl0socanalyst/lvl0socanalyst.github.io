---
layout: post
title:  Reverse Engineering a Phishing Email My Sister Clicked On!
date:   2026-01-11 21:00:00 +1000
categories: malware analysis
---

## Overview

Sister called. Downloaded a "pdf". When opened some "weird stuff" happened.

### The email

![Everyone](/images/email.PNG)

Interesting lure. I guess it invokes the not-so-tech-savy-definitely-not-stupid victim to the attachment, well because they didn't approve any "housing project" plans!

File name:
```javascript
Quotation_pdf.htm
```
HTM files are technically .html files however are far more legacy, both opened in web browsers and both display a page to a user.

The email is from "oriana.rybinska@subal.com.pl". Sorry I mean "Matthew Richie".
- ".pl" is the country code for Poland. 
- "subal.com.pl" looks to be a legitimate business domain for a Polish Manufacturer that specialises in display racks, hangers and compromised business emails.

So seems like we have a compromised email for a legitimate business that has been used to send out phishing emails. 

Usually this technique sends emails to victims that are known to the business, however, given my sister is based in Australia I doubt she's been in contact with this business. Perhaps the email has been scraped from Google.

Opening up the "subal.com.pl" website does not indicate anything malicious.

Likely the account of Oriana Rybinska has been compromised and that is it.

### Quotation_pdf.htm analysis

![Everyone](/images/htm.PNG)

Start of the .htm looks interesting. Body contains a png file that is B64 encrypted.

This blob is quite large. 197,300 characters to be exact. Whacking it into CyberChef and decrypting from B64 confirms it is infact a png file as it matches the expected headers for a .png file

![Everyone](/images/cyber_output.PNG)

Scrolling down further we see an interesting div

![Everyone](/images/div.PNG)

Looks to be another B64 png file. However, the form method is a POST and the name is "ogogoroman"

Fun fact according to google "ogogoroman" is a Nigerian Palm Wine Spirit. Co-incidence? I think not...

Lastly we have another few interesting div's.

![Everyone](/images/final.PNG)

Before we start analysing it's great to know my connection is encrypted by AES-256 and has been verified. I feel so much safer.

This is the div that collects the user input.
- Input name for password is "kokoro"
- Input name for email (prefilled) is "oruko"

But, most importantly we have a script that is pulled from "theprocesssolution.com/path/nss.js" that is ran. I dare say this is going to handle the logic within the 'verified' and 'ogogoroman' divs.

Now before we move on it's important to note:
- "Kokoro" is a nigerian snack (cheeky name for a password)
- "Oruko" is name in Nigerian

So, pretty confident we have a NiGeRiAn HaXoR thus far. Surprised it's not a romance scam.

Ohhhh and here is the landing page.

![Everyone](/images/lure.PNG)

### ProcessSolution.com

Nslookup gives us the following IP

![Everyone](/images/ns.PNG)

ValidIn say's this is a GoDaddy IP. Reeks of shared hosting.

![Everyone](/images/valid_ns.PNG)

It's resolved historically to tonnes of different domains, none of which look inherently malicious. Therefore, it's same to assume this IP is likely shared hosting web server and not a VPS or anything spicy.

However, the HTML at "theprocesssolution.com" returns something quite interesting.

![Everyone](/images/resolve.PNG)

Site displays the default WordPress Maintenance screen. However, it gives the email "admin@doorsconcepts.com" as a contact for enquiries.

![Everyone](/images/back.PNG)

Now to dig this hole even deeper "Doorsconcepts.com" is a legitimate domain for a Flordia Based cabinet making business.

So our Nigerian HaXoR is hosting .js on "theprocesssolution.com" which is owned by "DoorsConcepts". 

Now it's important to note there is a similarity in the sector being targeted here, both are small businesses and focus on manufacturing.

### The JavaScript (nss.js)

So, our .htm called to "theprocesssolution.com/path/nss.js". Let's see what we have here.

98 lines of JS. Non-obfuscated and easy to read. How good.

```javascript
fetchLocationFromIP()
``` 
![Everyone](/images/location.PNG)

Looks like it gathers information on victim location. This would occur when the page is loaded. No clicks are required for this function to trigger.

Pings out to "ip-api" and returns:
- Country
- Region name
- City
- ISP

```javascript
handleSubmission()
```
![Everyone](/images/handle.PNG)

This function supports the functionality for the user entering there password and presents text to make it seem more believable, I guess.

```javascript
sendToTelegram()
```
![Everyone](/images/tele.PNG)

Pretty stock standard, POST request to the variable stored in ```url``` in a JSON format

```javascript
teSile()
```
![Everyone](/images/te.PNG)

This is where most of our logic lies
1. Collects form data in "ogogoroman"
2. Collects IP data by calling "fetchLocationFromIP" function
3. Exfiltrates to Telegram Bots by calling "sendToTelegram" function through the variable "payload"
4. Redirects user to "Office.com" using ```windows.location.href```

```javascript
CrownJewels()
```

![Everyone](/images/hellohello.PNG)

Well what do we have here. That wouldn't happen to be some cleartext telegram bot tokens with API keys.

In summary we have a phishing page.. For Adobe I guess. That is sending exfiltrated data to a telegram bot, oh boy this is going to be fun.

### Bot Recon

Let's do some bot recon.

![Everyone](/images/first.PNG)

First name Adobe. Last name 25. Can join groups. This may be good later.

Based on the .JS from above there is two chat's that it exfilitrates too. Let's enumerate both.

![Everyone](/images/chats.PNG)

ChatIDs are tied to two legitimate accounts!
1. Mark Hill (mark_hill05)
2. BigDrake00 - "Learn from yesterday, Live for Today. Hope for tomorrow"

Well few things we can pull from this. "Mark_hill05" sounds a lot like a legit account, however, Mark Hill also sounds Nigerian. The reason I suspect it's legit is because of the 05 at the end, insinuating the user's age. But could be wrong.

Most importantly, BigDrakes quote, I'm almost in tears. So inspirational brother.

### Mark_hill05 Logs

After running my forwardMessage bash script we have some sample logs.

First let's dig into the logs that have been sent to "mark_hill05"

![Everyone](/images/logs.PNG)

===HOTMAIL LOGS=== mimicks what we saw during our .JS earlier. Therefore, the logs we are seeing are definitely from there.

First thing to note is that the messageID number is 49097 when I sent a test message to it. Therefore, the bot has sent 49097 messages to "mark_hill05" which is an awful lot.

When I try enumerating those earlier messages it fails, likely because the message has been deleted.

Logs contain:
- Email
- Password
- IP information

IP information is useful for an attacker as they can connect to a proxy/VPN in that error to try and bypass conditional access policies that the account may have on it.

### BigDrake00 Logs

Yikes, after sending a test message to BigDrake00 as the bot I received the messageID 49172. Therefore, indicating that I have sent the 49172nd message to BigDrake00 as the bot.

These logs are pullable from messageID 0 upwards, indicating BigDrake00 hasn't purged any older logs unlike mark_hill05.

### Next Steps
1. Pull as many logs as possible.
2. Dig into the Nigerian IPs and fuzz data that is likely the attackers
3. Look into /sendDocument API and others that provide bot functionality.
4. Send blurry .png's with embedded payloads
5. Use /editMessageText API to edit the logs I have sent to the user.

### Send Document?

Well, Telegram has a pretty neat feature where you can send a document from a bot to a user it has communicated with previously.