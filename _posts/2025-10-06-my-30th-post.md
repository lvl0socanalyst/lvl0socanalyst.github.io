---
layout: post
title:  "Dismantling a Telegram Bot - South African PhaaS - O365 and RATs"
date:   2025-09-16 21:00:00 +1000
categories: malware analysis
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

An Adobe landing page delivering GoToResolve RAT, with lots going on in the background.

### Adobe Landing Page

Convincing? I don't think so.

![alt text](/images/secure_download.PNG)  

We have a .html document loaded by our browser called 'Secure_Adobe_Document' which is delivered from the domain hXXps://gc[.]wwrkk[.]uk/

Furthermore, we also have a telegram bot api message /sendMessage. This will be fun to mess with.

### What is downloaded?

We have a simple .msi file that is sitting around 23mbs.

After extracting the contents of the .msi safely using lessmsi we can see the following .exe

![alt text](/images/lessmsi_result.PNG)

This is it in DiE (Detect It Easy)

![alt text](/images/die_goto.PNG)

Essentially what we have is an install for GoTo Resolve RAT, pretty simple. The loader is the .msi file I guess. Nothing fancy, straight forward RAT with no obfuscation.

![alt text](/images/vt_goto.PNG)

This hash lights up like a Christmas tree on VT, no surprise.

![alt text](/images/jank_result.PNG)

And when I run my jank script for C2 IOCs we get the following:
- hXXps://dumpster[.]console[.]gotoresolve[.]com
- hXXps://dumpster[.]dev01-console[.]gotoresolve[.]com

These are the C2 domains preconfigured for GoToResolve RAT. However, these are domains used by anyone who uses the GoToResolve RAT. Buttttt, depending on what parameters are in the HTTP request the response server side varies. This will make more sense later on.

### Telegram Bot Deep Dive

At the start of the JS in the .html we have a few constants with some API information.
- TELEGRAM_BOT_TOKEN
- TELEGRAM_CHAT_ID

![alt text](/images/telegram_bot.PNG) 

These hold the keys to the kingdom. This can allow us to identify what the bot is called, what perms it has and hopefully some other juicy info. Furthermore, the chat id tells us where the bot is sending it's data to. This is a common setup I've seen a lot.

![alt text](/images/telegram_function.PNG) 

Above we can see the JS that provides the functionality for hitting the telegram bot. Uses fetch to send the message in the form of a HTTP POST. Furthermore, if ``humanInteractionDetected'' is not true. The JS doesn't send a POST request to the telegram bot.

Now we have is the what the sendMessage API is sending.

When I run the page in my browser I can see the following request sent to the telegram API in dev tools.

``{"chat_id":"6741196511","text":"[Secure Document] Event: document-validated\nFile: Secure_document.msi\nTime: 10/21/2025, 2:43:19 AM\nIP: unknown"}``

So what does this mean?

The attacker is collecting the IPs of the users that have interacted with the Adobe phishing page for the file 'Secure_document.msi'.

This is likely for configuration of what IPs are accepted at hXXps://dumpster[.]console[.]gotoresolve[.]com or hXXps://dumpster[.]dev01-console[.]gotoresolve[.]com. Therefore, the beacon traffic can be redirected to the attackers GoToResolve RAT control page. 

I'd assume the attacker is running automation on the Telegram chat for IPs. Likely a python script that then interacts with the GoToResolve RAT admin configuration page.

### Beep Bop Bot (Simulated activity)

Sooooooo..... What can we do with a bot token and a chat id?

![alt text](/images/telegram_getMe.PNG)

This tells us it's name, telegram id and what permissions it has.

Besides that can see that it can join groups.

So there's a few things we can do from here, hypothetically of course. We can act as the bot, spam an telegram API with packets and get the bot rate limited and thus banned.

Or we can register a webhook for the bot. Essentially redirecting all the traffic to ourselves. I may have choose the latter.

![alt text](/images/webhook_site.PNG)

Webhook[.]site has free webhooks for up to 100 hits. Pretty neat and can register as many as you want/need.

![alt text](/images/webhook_set.PNG)

Sooooo now every command that users send to the bot, I get sent to my webhook. Can be useful for determining who owns it! Also, saves me from exposing my telegram ID, not that it really matters anyway.

For clarification, I am not recieving logs from the JS. I am just receiving commands that are sent to the bot.

![alt text](/images/data_webhook.PNG)

Well well well. What do we have here.

Looks like someone with the telegram handle 'mikewells003' tried sending a /start command to the bot.

``is_bot`` is also false. Therefore, a legitimate user initiated this activity, nice.

Another thing I can do is have a look for info about the chatid. 

Circling back on our friend 'mikewells003'. I reckon this is another security researcher like myself tbh.

To communicate with a bot from your telegram account you need to /start the bot yourself. This gives it permission to talk with you. 

Once the bot can talk to you. You can set a destination chat that you own and forward all previous messages the bot has sent to that chat ID from earlier to yourself.

### What's in that chat?

Here is what the output would have looked like if I was to try and forward these messages to my own telegram chat id.

![alt text](/images/telegram_result.PNG)

Now note the date being the 14th of July. Today is the 21st of October. 

Therefore, this bot has been active for quite some time. 

Furthermore, the log sample above is a lot different to the logs that the .JS on the webpage sends to the bot. The .JS on the webpage only sent the following:
- ``{"chat_id":"6741196511","text":"[Secure Document] Event: document-validated\nFile: Secure_document.msi\nTime: 10/21/2025, 2:43:19 AM\nIP: unknown"}``

What this tells us is that this bot has been historically for what looks likely to be O365 phishing, hence the name of the bot as well.

![alt text](/images/telegram_other_result.PNG)

Now this is what I expected to see, as it mimcks the behaviour in the .JS.

![alt text](/images/blues_start.PNG)

![alt text](/images/telegram_chatinfo.PNG)

What we have here is a telegram user account called 'BluesSnip' and a telegram chat id. The user also has a premium subscription. 'BluesSnip' sent the first ever message to the bot, so very likely this is the owner.

### Findings, that aren't nasty logs

Within these results there is some pretty interesting information, looks the creator of this bot is using a paid service of some sort. There are multiple messages referencing a VPS and apologising for downtime.

![alt text](/images/result_tele.PNG)

Looks like someone testing logs from a Netherlands IP.

![alt text](/images/interesting.PNG)

Now, this is interesting now. I am not too sure what this means. But perhaps the threat actor was testing the bot was working? It's very odd different email domains but coming from the same IP. 

![alt text](/images/weird.PNG)

Interesting! Cyborg Solider runs the VPS?

![alt text](/images/another_one.PNG)

![alt text](/images/more.PNG)

Okay, I'm pretty confident it's PhaaS now. 

![alt text](/images/another_two.PNG)

This is all building good context now, unfortunately the group invite has expired. That would have been great.

![alt text](/images/phishing.PNG)

I assume these are phishing themes offered by the PhaaS providers?

### Smile Cookies?

Going to circle back on this. Likely javascript on the malicious webpage that is likely determining whether MFA is enabled for the user after there credentials are phished. Or perhaps it is actually receiving this data from a VPS, after it trials a login? Not sure yet. At first glance I can't find anything on the surface web regarding 'Smile Cookies'.

### Who's that pokemon? (threat actor)

So I can see a few IPs testing the bots functionality. 
- ``109.248.151.138``
- ``109.248.144.166``
- ``41.13.198.22``
- ``105.233.147.114``

First thing I did was to see if any cookies we're stolen during the testing. Unfortunately not.

![alt text](/images/evidence.PNG)

The format these IPs are using to test the bots is a numeric password such as '1111999231' or '7777775'. Furthermore, multiple tests come within 5 - 10 minutes. Because of this pattern, I can confidently attribute these to the PhaaS provider checking the bots functionality.

1. ``109.248.151.138``
2. ``109.248.144.166``

They share the same ASN and CIDR range. 

![alt text](/images/asn.PNG)

Domain name for the ASN is 'rixhost.lv'

Bit of further OSINT shows that the company is based in Lativa, with 67% of there servers being hosted there. Multiple reported IP ranges in AbuseIPDB, and known to route through Tor.

![alt text](/images/rdp.PNG)

Bingo, confirmed my suspicions. 3389 is RDP. Given what we know above and the reputation of the ASN. These are very very likely the threat actors VPS. 

3. ``41.13.198.22``

![alt text](/images/vodacom.PNG)

Okay, this is interesting. The PTR record last seen on the 21st is a reverse dns address that is in Johannesburg South Africa. It is also a mobile connection. This means one of two things in my head.
1. The PhaaS developer is testing the phishing page on his mobile device.
2. The PhaaS developer's VPS connection dropped and was hotspotting.

For further re-inforcement of this idea. As seen in the screenshot above, the individual tried with the same email address, three minutes apart, from first the VPS IP and then the mobile IP.

I am super duper confident, this confirms the PhaaS provider is from South Africa.

4. ``105.233.147.114``

![alt text](/images/cybersmart.PNG)

This looks like a South African broadband IP. ASN funnily enough is called 'CyberSmart', it is South Africa's "Top ISP"

Hahah! Yes! When I search the logs for "South Africa" we also get two more IPs from this ASN! Both that are doing the same testing as observed with the VPS IPs. 

5. ``105.233.91.54``
6. ``105.233.146.0``

What is important to note here is these three IPs from CyberSmart ASN are all in Cape Town.

Therefore, I can say we a high degree of certainty the PhaaS provider is from Cape Town.

### Robin Hood Arc

So.. We have some sample logs. How about we message the users and let them know. Because, well it's the right thing to do.

After some regex on the sample data I've got 151 email addresses.

Now, likely won't be believed here. However, it's still worth a go. For obvious reasons sending from a email address I am not associated with, so may look odd to the users. But then again, if they're stupid enough to fall for O365 phishing, they'll probably believe me.

Anyway, now that's been sent off I can sleep at night.

### Shoot I almost forgot

Well, now we've done our investigation. There is only really one thing left to do.

Use to the bot to spam ``BluesSnip`` with funny messages until it gets rate limited and banned.

Because BluesSnip has a premium plan, this is a lot harder than normal and technically can't really get the bot banned. Unless you report to telegram, which lets be honest is never gonna work.

![alt text](/images/payload_south_africa.PNG)

But you can send lots of nice messages in a reoccuring loop until it eventually does.

![alt text](/images/thread.PNG)

I ran this script on a bot that I own for testing, 629 messages we're sent in testing. 

== The End ==