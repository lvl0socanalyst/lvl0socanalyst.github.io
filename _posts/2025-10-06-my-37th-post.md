---
layout: post
title:  SANS Holiday Hack 2025
date:   2025-12-23 21:00:00 +1000
categories: ctfs
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

SANs holiday hack CTF over the Christmas period!

Free SANs voucher up for grabs.

Here I'll whack some explanations for the more interesting challenges/flags.

### Azure CLI Challenges

Never used Azure CLI before, this was tough to pickup on the go. Here are some commands to help with future CTFs and Azure CLI work.

``az account show``
- Shows account details

``az storage account list --account-name <ENTER>``
- Shows storage for an account
- Can also filter by resource group ``--resource-group <ENTER>``

``az storage blob list --account-name <neighborhood2> --container-name <public>``
- Shows the files inside a blob for a given container

``az storage blob download --file /dev/stdout --container-name  public --account-name neighborhood2 --name admin_credentials.txt``
- Downloads a file within a blob and outputs to CLI

``az group list -o table``
- Shows all resource groups

``az network nsg list -o table``
- Shows all Network Security Groups (NGSs) configured

``az network nsg rule list --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 --query "[].name" -o table``
- Shows all NSG rules for nsg group and filters by name into a neat table

``azaz network nsg rule show --resource-group theneighborhood-rg1 --nsg-name nsg-production-eastus --name Allow-RDP-From-Internet``
- Show a specific rule in CLI

### Curl for querying an IMAP Server?

Curl is cool. Usually used for pinging web apps and modifying headers to bypass WAFs, this challenge demonstrated a far less nefarious way to use it!

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Inbox/ -X 'UID SEARCH ALL'``
- Searches Inbox on IMAP server and lists UID of the emails

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Inbox/ -X 'UID FETCH 1:* (BODY[HEADER.FIELDS (FROM TO SUBJECT DATE)])'``
- Fetches email headers for emails in Inbox

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Archives/ -X 'UID FETCH 42 BODY[]'``
- Fetches specific email based on UID (e.g. 42) and displays body

### DosisNetwork - Exploiting Router CVE

This challenge was cool. 

Presented with a router login page. Challenge is to login.

![Everyone](/images/vulnerable.PNG)

First thing I tried was bruteforcing, however, got rate limited real quick.

Secondly, if we google the following details:
- AX1800 Wi-Fi 6 Router
- Firmware Version is 1.1.4 Build 20230219 rel. 69802
- Hardware Version is Archer AX21 v2.0

We can see there is a command injection CVE for the router model.

CVE-2023-1389
- (https://www.tenable.com/security/research/tra-2023-11?ref=blog.razrsec.uk)

Tenable post states the following:
- "The country parameter, of the write callback for the country form at the /cgi-bin/luci/;stok=/locale endpoint is vulnerable to a simple command injection vulnerability. 
The country parameter was used in a call to popen(), which executes as root, but only after first being set in an initial request."

Therefore, we can append a command to the end of that URL
- ``https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country&country=$(cat /etc/passwd)``

![Everyone](/images/cat.PNG)

So to find the password for the login page we want to check ``/etc/config/wireless`` according to LordGPT

- `` https://dosis-network-down.holidayhackchallenge.com/cgi-bin/luci/;stok=/locale?form=country&country=$(cat etc/config/wireless)``

![Everyone](/images/key.PNG)

And just like that, we have our login!