---
layout: post
title:  SANS Holiday Hack 2025
date:   2025-12-23 21:00:00 +1000
categories: CTFs
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

SANs holiday hack CTF over the Christmas period!

Free SANs voucher up for grabs.

Here I'll whack some explanations for the more interesting challenges/flags.

### Azure CLI Challenges

Never used Azure CLI before, this was tough to pickup on the go. Here are some commands to help with future CTFs and Azure CLI work.

``az account show``
- Shows account details

``az storage account list --account-name <ENTER>``
- Shows storage for an account
- Can also filter by resource group ``--resource-group <ENTER>``

``az storage blob list --account-name <neighborhood2> --container-name <public>``
- Shows the files inside a blob for a given container

``az storage blob download --file /dev/stdout --container-name  public --account-name neighborhood2 --name admin_credentials.txt``
- Downloads a file within a blob and outputs to CLI

``az group list -o table``
- Shows all resource groups

``az network nsg list -o table``
- Shows all Network Security Groups (NGSs) configured

``az network nsg rule list --nsg-name nsg-production-eastus --resource-group theneighborhood-rg1 --query "[].name" -o table``
- Shows all NSG rules for nsg group and filters by name into a neat table

``azaz network nsg rule show --resource-group theneighborhood-rg1 --nsg-name nsg-production-eastus --name Allow-RDP-From-Internet``
- Show a specific rule in CLI

### Curl for querying an IMAP Server?

Curl is cool. Usually used for pinging web apps and modifying headers to bypass WAFs, this challenge demonstrated a far less nefarious way to use it!

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Inbox/ -X 'UID SEARCH ALL'``
- Searches Inbox on IMAP server and lists UID of the emails

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Inbox/ -X 'UID FETCH 1:* (BODY[HEADER.FIELDS (FROM TO SUBJECT DATE)])'``
- Fetches email headers for emails in Inbox

``curl -v -u "dosismail:holidaymagic" imap://127.0.0.1/Archives/ -X 'UID FETCH 42 BODY[]'``
- Fetches specific email based on UID (e.g. 42) and displays body