---
layout: post
title:  "Allow Notifications Clickfix?"
date:   2025-09-09 21:00:00 +1000
categories: malware analysis
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

Clickfix prompt that asks users to allow push notifications? Why?

### Front-end

Here we can see a classic Cloudflare clickfix prompt. 

![alt text](/images/landing_page2.PNG)

However, when we hit that darn awful tick box we get this.

![alt text](/images/stage2_page.PNG)

I can't explain how hard this stumped me.

Anyhow, let's dig into the back end. 


### Back-end

We have about 1000 lines of code here. First 650 lines is internal CSS and HTML (lame).

Booting up dev tools we can see the HTML and JS is stored locally on the webserver.

![alt text](/images/sources.PNG)

Only external call is for a .png file

Which hilariously is a transparent version of the CloudFlare logo. Pulling a CloudFlare logo from a free .png pasting website. Super legit. 

![alt text](/images/post_images.png)
![alt text](/images/png_call.PNG)

So that leaves us with this 'jq.js' file stored on the webserver. 

Alright we now have 268 lines of raw js, managable.

![alt text](/images/pub_key.PNG)

First we can see a public key I assume for an API of some sort. Looking juicy and totally not exploitable already.

![alt text](/images/base_64.PNG)

Hmmmm, this is interesting. Looks like it takes a B64 string and converts it to a Uint8Array using ``window.atob``

![alt text](/images/memer.PNG)

Function name is hilarious. Great to know the nefarious folks are memers too.

But seriously, this function sends the text 'yep' to 'index.php' using a POST request. Then waits for a response. If the response status is "success" is redirects to the homepage, hence the ``./``

![alt text](/images/samsung.PNG)

Now, the fact this is commented out makes me believe this is MaaS. But can't be certain yet. Looks to be the .js function for creating the push notification popup for Samsung and IOS users.

![alt text](/images/send_subscription.PNG)

Another Ajax POST request. This time to a .php file on the domain ``xtolz[.]com``

Sends a POST request in JSON format to ``xtolz[.]com``. If the response is "success" it'll run the meme function from earlier (OkeyNice()). Which essentially redirects the user to the homepage of ``hyroalabs[.]site``

Now in terms of exfil. What have we got.
- endpoint
- public_key
- auth_token
- content_encoding

First I thought these we're variables. But they aren't anywhere else in the code. So that means they exist somehow natively in the browser and are known values. 

A quick google lead me to PushManager.

PushManager is browser API that can allow a web application to send push notifications to a browser client.

So the function above. Is subscribing us, the user to the receive push notifications from ``xtolz[.]com``

Now to blow your mind (and mine rn) this means that the ``xtolz[.]com`` can send push notifications to my isolated browser at any point in time. Until I remove it. 

![alt text](/images/push_manager.PNG)

This is the function that creates the subscription, which is later exfiled.

### Network IOC dig

### How to remove subscriptions?

Site Settings --> Notifications --> Block or Remove

### Threat actor attribution?
