---
layout: post
title:  "Push Notifications Clickfix - Morocco IAB Attribution"
date:   2025-09-20 21:00:00 +1000
categories: malware analysis
---

## Overview

Clickfix prompt that asks users to allow push notifications? Today I'll deep dive into how this works and attribute the attacker as well!

### Front-end

Here we can see a classic Cloudflare clickfix prompt. 

![alt text](/images/landing_page2.PNG)

However, when we hit a tick box we get this.

![alt text](/images/stage2_page.PNG)

I can't explain how hard this stumped me.

Anyhow, let's dig into the back end. 

### Back-end

We have about 1000 lines of code here. First 650 lines is internal CSS and HTML (lame).

Booting up dev tools we can see the HTML and JS is stored locally on the compromised website's webserver.

![alt text](/images/sources.PNG)

Only external call triggered by JavaScript is for a .png file

Which hilariously is a transparent version of the CloudFlare logo. Pulling a CloudFlare logo from a free .png pasting website, this is looking very legit.

![alt text](/images/post_images.PNG)
![alt text](/images/png_call.PNG)

So that leaves us with this ``jq.js`` file stored on the webserver. 

Alright we now have 268 lines of raw js, managable.

![alt text](/images/pub_key.PNG)

First we can see a public key I assume for an API of some sort. Looking good. 

![alt text](/images/base_64.PNG)

Hmmmm, this is interesting. Looks like it takes a B64 string and converts it to a Uint8Array using ``window.atob``

![alt text](/images/memer.PNG)

```javascript
OkeyNice()
```

Function name is hilarious. Great to know the nefarious folks are memers too.

But seriously, this function sends the text 'yep' to 'index.php' using a POST request. Then waits for a response. If the response status is "success" is redirects to the homepage, hence the ``./``

![alt text](/images/samsung.PNG)

```javascript
registerAndSubscribe()
```

This the .js function for creating the push notification popup for Samsung and IOS users. Now, the fact this is commented out hints towards MaaS. 

![alt text](/images/send_subscription.PNG)

Another Ajax POST request. This time to a .php file on the domain ``xtolz[.]com``

Sends a POST request in JSON format to ``xtolz[.]com``. If the response is "success" it'll run the meme function from earlier ``OkeyNice()``. Which redirects the user to the homepage of ``hyroalabs[.]site``

![alt text](/images/exfil_hy.PNG)

From the code review this is what I've determined the exfil to be:
- endpoint (unique to user, subscription creates this)
- public_key
- auth_token
- content_encoding

First I thought these we're variables, but they aren't anywhere else in the code. So that means they exist somehow natively in the browser and are known values. 

A quick google lead me to PushManager.

PushManager is browser API that can allow a web application to send push notifications to a browser client.

So the function above. Is subscribing the user to the receive push notifications from ``xtolz[.]com``

The exfilitrated data is just the information required for xtolz[.]com to be able to send push notifications to your browser. This is unique to each subscription. 

Now to blow your mind (and mine rn) this means that the ``xtolz[.]com`` can send push notifications to a victim's browser at any point in time. Given that they accepted the push notification popup. Permissions to do are upheld until a user manually removes the subscription.

![alt text](/images/push_manager.PNG)

This is the function that creates the subscription.

The VAPID key is a public key for the push notification flow. The private key lives on the server. The public key lives in the JS. The public/private key are used to generate a PushSubscription object that then lives in the user's browser. This objects allows the registered domain to send push notifications to the user's browser.

![alt text](/images/hyora_login.PNG)

Alright interesting, can see here that this is likely created by "GROWCRM.IO"

![alt text](/images/dork.PNG)

Quick dork shows that they are a CRM offering. Interesting. 

Two things that may have occurred here. The website itself has a vulnerability that has allowed for code injection/remote code execution. Or the admin account for GrowCRM.io that allows modifcation to hyoralabs has been compromised and malicious code was appended to the site.

### What is xtolz[.]com?

Clickfix prompt sends the POST request to the xtolz[.]com. So what is it? And what is the URL? Looks like a panel.. But for what?

Well looks like we have a marketplace. 

![alt text](/images/offerings.PNG)

This is everything they sell. CPanel and Shell access for example. Along with a load of other stuff. 

But that still doesn't answer why the push subscription sends a POST request to this? I'm a touch confused. 

It would seem like there is backend functionality on the site to accept these push subscriptions. So I feel like the site was compromised by the owner of xtolz[.]com

Kind of cool.

![alt text](/images/shell.PNG)

$3 for shell access to a website. Neat. This is darn cheap.

### Counter attack?

Wellllll.... If we have a look at the original POST request. It passes in some json data to an API assumedly that lives at xtolz[.]com

Sooooo hypothetically (of course) you could push a bunch of dummy data to the endpoint and clog up old mates logs.

There may or may not be a WAF as well, which may or may not make this incredibly easy to do.

### So who did it?

![alt text](/images/osint.PNG)

Bit of OSINT shows old mate is very likely from Morocco. The Facebook group has less than 10,000 members so is quite niche. 

![alt text](/images/telegram_acc.PNG)

Annddd here is the owner's telegram account. Username doesn't get any hits anywhere else. So seems unique, bummer.

### How to remove subscriptions?

Site Settings --> Notifications --> Block or Remove