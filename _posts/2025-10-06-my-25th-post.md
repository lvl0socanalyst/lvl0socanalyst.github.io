---
layout: post
title:  "CrowdStrike PsFalcon Bulk Containment Script"
date:   2025-09-09 21:00:00 +1000
categories: scripts
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

SSO is down. Ransomware is spreading throughout your environment. You can't login to CS to isolate hosts. You are a sitting duck. Hold on. Stop. No need to fear, a jank script has appeared.

### PsFalcon 

CrowdStrike has a Powershell Module called PsFalcon.

Installing this module allows for scripts to query the CS API with both read and write requests.

It is available for Python and PowerShell. I choose PowerShell. Why? Well because ```pip install``` is enough to make a grown man cry.

To query this API you need to create a key via CS.

CS Support --> API Keys and Audit --> Create Key

Here you can assign the relevant privileges to your API key. When you create the key you can tick the boxes.

Documentation for what each permission means lives in the PsFalcon Wiki here - [PsFalcon Wiki](https://github.com/CrowdStrike/psfalcon/wiki)

After you create your key you will be given a Client ID and Secret ID. 

These two goodies are used to provision a OAuth token to you when you authenticate at the start of this jank script.

To install the PsFalcon module in Powershell run this command with elevated privileges

```Install-Module -Name PSFalcon -Scope CurrentUser```

### Prerequisites

1. Half a brain
2. API Client ID and Secret ID
3. PsFalcon Module installed
4. A .csv file full of malware infected hosts

### How to use

Script should be super simple to use given that the pre-reqs are sorted.

Script has the following functions:
- Isolate Host
- Unisolate Host
- Display Host Details

Steps:
1. Open up script in a PowerShell shell
2. Enter clientID and secretID
3. Select option
4. Select data input method
5. Enter file path or enter hostname
6. Badda Bing Badda Boom (it's done)

### Jank Script

Script lives here - [PsFalcon Isolation Script](https://github.com/lvl0socanalyst/Scripts/blob/main/psfalcon_isolation_script.ps1)
