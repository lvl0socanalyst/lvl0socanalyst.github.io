---
layout: post
title:  "Strings regex IOC powershell script"
date:   2025-09-09 21:00:00 +1000
categories: scripts
---

<style>
  body { font-size: 16px; }
  body {font-family: 'Inter', sans-serif}
  h1 { font-size: 19px !important; }
  h2 { font-size: 17px !important; }
  h3 { font-size: 15px !important; }
</style>

## Overview

Script scans a files in a directory using strings for matches on a given set regex patterns.

Super useful when you have a bunch of malicious files to extract IOCs from. Or just one file you want to try and snoop IOCs from. A lot easier than manually scrolling or remembering (prompting AI) for regex patterns.

### Prerequisites 

- Strings installed [Sysinternals](https://learn.microsoft.com/en-us/sysinternals/)
- Malware [Malware Sample](https://www.youtube.com/watch?v=dQw4w9WgXcQ)
- Half a brain

### Breakdown

Code breakdown of the script.

Can also be found here if you don't wanna read. It is only like 80 lines, pretty easy to follow.

[Strings Regex IOC Script](https://github.com/lvl0socanalyst/Scripts/blob/main/strings64_regex_pattern_script.ps1)

![alt text](/images/strings_1.PNG)

These first five variables values will need to be modified before running the script. I could have asked for user input but tbh that's more annoying when you're trying to run it. Just open with notepad and add the file paths.

![alt text](/images/strings_2.PNG)

This is where you define your regex patterns. You can add as many as you like. Furthermore, configure to your liking.

![alt text](/images/strings_3.PNG)

Uses strings to loop through each file in the directory and apply the regex patterns defined above to the binary data in the file.

![alt text](/images/strings_4.PNG)

Spits out the results grouped by regex pattern

### Output

![alt text](/images/strings_5.PNG)

Output has everything you'd ever want. My current regex queries are quite broad. But I prefer that and going through and deleting irrelevant hits.

